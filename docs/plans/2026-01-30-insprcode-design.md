# çµåˆ› (insprcode) è®¾è®¡æ–‡æ¡£

> é¡¹ç›®åç§°ï¼šçµåˆ› (insprcode)
> æ—¥æœŸï¼š2026-01-30
> çŠ¶æ€ï¼šè®¾è®¡å®Œæˆï¼Œå¾…å®æ–½

## 1. é¡¹ç›®æ¦‚è¿°

### å®šä½

ä¸º Vibe Coding å¼€å‘è€…æä¾›éšæ—¶éšåœ°ç›‘æ§å’Œæ§åˆ¶ Claude Code çš„èƒ½åŠ›ï¼Œè§£å†³ã€Œç­‰å¾…ç„¦è™‘ã€å’Œã€Œå¤šçª—å£ç®¡ç†ã€ç—›ç‚¹ã€‚

### ä»“åº“ç»“æ„

```
.submodules/
â”œâ”€â”€ insprcode-skill/     # å¼€æº - Claude Code Hook é›†æˆ
â”œâ”€â”€ insprcode-server/    # å¼€æº - æœåŠ¡ç«¯ + PWA
â””â”€â”€ insprcode-app/       # é—­æº - Flutter åŸç”Ÿ App (åç»­)
```

### å¼€æºç­–ç•¥

| ä»“åº“ | å¼€æº | è¯´æ˜ |
|------|------|------|
| insprcode-skill | âœ… | å¸å¼•ç¤¾åŒºè´¡çŒ®ï¼Œé™ä½ç”¨æˆ·æ¥å…¥é—¨æ§› |
| insprcode-server | âœ… | æ”¯æŒè‡ªæ‰˜ç®¡ï¼Œå»ºç«‹æŠ€æœ¯ä¿¡ä»» |
| insprcode-app | âŒ | å•†ä¸šåŒ–è½½ä½“ï¼Œå·®å¼‚åŒ–ç«äº‰ |

### éƒ¨ç½²æ¨¡å¼

- **SaaSï¼ˆé»˜è®¤ï¼‰**ï¼šæ‰˜ç®¡æœåŠ¡ï¼ŒK8s éƒ¨ç½²ï¼Œæ¥å…¥ inspirai-user/admin
- **è‡ªæ‰˜ç®¡**ï¼šå•äºŒè¿›åˆ¶ï¼Œé›¶ä¾èµ–ï¼Œä¼ä¸š/éšç§ç”¨æˆ·å‹å¥½

---

## 2. æŠ€æœ¯æ¶æ„

### æŠ€æœ¯æ ˆæ€»è§ˆ

| ç»„ä»¶ | æŠ€æœ¯é€‰å‹ | è¯´æ˜ |
|------|----------|------|
| **insprcode-skill** | TypeScript/Node.js | Claude Code Hook è„šæœ¬ |
| **insprcode-server** | Go æ¨¡å—åŒ–å•ä½“ | API + WebSocket + å†…åµŒ PWA |
| **PWA å‰ç«¯** | Vue 3 + Naive UI + Vite | è½»é‡ç°ä»£ï¼Œä¸»é¢˜å®šåˆ¶å¼º |
| **å®æ—¶é€šä¿¡** | WebSocket | çŠ¶æ€æ¨é€ã€è¿œç¨‹æ§åˆ¶ |
| **é€šçŸ¥** | Telegram Bot (Long Polling) | ä¸»åŠ›é€šçŸ¥æ¸ é“ |
| **å­˜å‚¨** | Redis + SQLite/MySQL | è‡ªæ‰˜ç®¡ç”¨ SQLiteï¼ŒSaaS ç”¨ MySQL |
| **insprcode-app** | Flutter (åç»­) | å…ˆ PWAï¼ŒååŸç”Ÿ App |

### ç³»ç»Ÿæ¶æ„å›¾

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                        å¼€å‘è€…æœ¬æœº                                â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”         â”‚
â”‚  â”‚ Claude Code â”‚    â”‚ Claude Code â”‚    â”‚ Claude Code â”‚         â”‚
â”‚  â”‚  (ä¸»çª—å£)   â”‚    â”‚ (Subagent1) â”‚    â”‚ (Subagent2) â”‚         â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜         â”‚
â”‚         â”‚                  â”‚                  â”‚                 â”‚
â”‚         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                 â”‚
â”‚                            â–¼                                    â”‚
â”‚                   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                           â”‚
â”‚                   â”‚ insprcode-skill â”‚ (Hook è„šæœ¬)               â”‚
â”‚                   â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜                           â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                             â”‚ HTTPS
                             â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    insprcode-server                             â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚                     API Layer                             â”‚  â”‚
â”‚  â”‚  /api/sessions    /api/commands    /api/orchestrator     â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”            â”‚
â”‚  â”‚ Session Mgr â”‚  â”‚ Orchestratorâ”‚  â”‚  Notifier   â”‚            â”‚
â”‚  â”‚ (ä¼šè¯ç®¡ç†)  â”‚  â”‚ (ä»»åŠ¡ç¼–æ’)  â”‚  â”‚ (é€šçŸ¥æ¨é€)  â”‚            â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜            â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚              Auth Provider (å¯æ’æ‹”è®¤è¯)                  â”‚   â”‚
â”‚  â”‚     Local Token â”‚ OIDC Provider â”‚ inspirai-user         â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                              â”‚
â”‚  â”‚    Redis    â”‚  â”‚ SQLite/MySQLâ”‚                              â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                             â”‚
              â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
              â–¼              â–¼              â–¼
        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
        â”‚ Telegram â”‚  â”‚   PWA    â”‚  â”‚   App    â”‚
        â”‚   Bot    â”‚  â”‚  (Web)   â”‚  â”‚ (åç»­)   â”‚
        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## 3. è®¤è¯ç³»ç»Ÿ

### å¯æ’æ‹”è®¤è¯æ¶æ„

```go
// AuthProvider æ¥å£å®šä¹‰
type AuthProvider interface {
    ValidateToken(ctx context.Context, token string) (*UserInfo, error)
    GetPublicKeys(ctx context.Context) ([]PublicKey, error)
    SupportsRefresh() bool
    RefreshToken(ctx context.Context, refreshToken string) (*TokenPair, error)
}
```

### æ”¯æŒçš„è®¤è¯æ¨¡å¼

| æ¨¡å¼ | é€‚ç”¨åœºæ™¯ | é…ç½®å¤æ‚åº¦ |
|------|----------|------------|
| **Local Token** | ä¸ªäºº/å°å›¢é˜Ÿè‡ªæ‰˜ç®¡ | æœ€ç®€å• |
| **OIDC Provider** | ä¼ä¸šè‡ªæ‰˜ç®¡ (Keycloak, Auth0, Okta) | ä¸­ç­‰ |
| **inspirai-user** | SaaS é»˜è®¤ | é›¶é…ç½® |

### é…ç½®ç¤ºä¾‹

```yaml
auth:
  provider: "oidc"  # local | oidc | inspirai

  local:
    tokens:
      - name: "alex-macbook"
        token: "sk-xxxx"
        permissions: ["read", "write", "admin"]

  oidc:
    issuer: "https://auth.example.com/realms/mycompany"
    client_id: "insprcode"
    claims_mapping:
      user_id: "sub"
      username: "preferred_username"

  inspirai:
    jwks_url: "https://api.inspirai.store/.well-known/jwks.json"
```

### SaaS ä¸è‡ªæ‰˜ç®¡è®¤è¯æµç¨‹å¯¹æ¯”

| åœºæ™¯ | è®¤è¯æµç¨‹ |
|------|----------|
| **SaaS** | ç”¨æˆ·é€šè¿‡ inspirai-user ç™»å½• â†’ JWT â†’ insprcode-server éªŒè¯ JWKS |
| **è‡ªæ‰˜ç®¡ (ä¼ä¸š)** | ç”¨æˆ·é€šè¿‡ä¼ä¸š OIDC ç™»å½• â†’ JWT â†’ insprcode-server éªŒè¯ |
| **è‡ªæ‰˜ç®¡ (ä¸ªäºº)** | é…ç½®æ–‡ä»¶è®¾ç½®é™æ€ Token â†’ insprcode-server ç›´æ¥éªŒè¯ |

---

## 4. Subagent ç¼–æ’ç³»ç»Ÿ

### æ ¸å¿ƒæ¦‚å¿µ

| æ¦‚å¿µ | è¯´æ˜ |
|------|------|
| **Plan** | ä»»åŠ¡è®¡åˆ’ï¼ŒåŒ…å«å¤šä¸ª Task åŠå…¶ä¾èµ–å…³ç³» |
| **Task** | å•ä¸ªä»»åŠ¡ï¼Œç”±ä¸€ä¸ª Subagent æ‰§è¡Œ |
| **Subagent** | ç‹¬ç«‹çš„ Claude Code çª—å£å®ä¾‹ |
| **DAG** | æœ‰å‘æ— ç¯å›¾ï¼Œæè¿°ä»»åŠ¡ä¾èµ–å…³ç³» |

### ä»»åŠ¡çŠ¶æ€æµè½¬

```
pending â†’ ready â†’ running â†’ done â†’ confirmed â†’ closed
            â†‘                  â†“
            â””â”€â”€â”€ failed â—„â”€â”€â”€â”€â”€â”€â”˜
                   â†“
              (é˜»å¡ä¸‹æ¸¸ï¼Œç­‰å¾…äººå·¥å¤„ç†)
```

### è°ƒåº¦æ¨¡å¼

```yaml
plan:
  name: "å®ç°ç”¨æˆ·è®¤è¯æ¨¡å—"
  mode: hybrid  # hybrid | manual | auto

  tasks:
    - id: schema
      prompt: "è®¾è®¡ç”¨æˆ·è¡¨ Schema"
      auto: true

    - id: api
      prompt: "å®ç°ç™»å½• API"
      depends_on: [schema]
      auto: true

    - id: frontend
      prompt: "å®ç°ç™»å½•é¡µé¢"
      depends_on: [api]
      auto: false  # éœ€æ‰‹åŠ¨å¯åŠ¨
```

### ç»“æœä¼ é€’æœºåˆ¶

| é€šé“ | å†…å®¹ | ç”¨é€” |
|------|------|------|
| **Git** | ä»£ç ã€é…ç½®æ–‡ä»¶ | ä¸‹æ¸¸ä»»åŠ¡ç›´æ¥è¯»å–äº§å‡ºç‰© |
| **æ‘˜è¦** | JSON/Markdown ç»“æ„åŒ–æŠ¥å‘Š | å¿«é€Ÿäº†è§£å®Œæˆæƒ…å†µ |

```json
{
  "task_id": "api",
  "status": "done",
  "summary": "å®ç°äº† /login å’Œ /register ä¸¤ä¸ª API",
  "files_changed": ["internal/handler/auth.go", "internal/service/user.go"],
  "git_commit": "abc123",
  "duration": "12m30s"
}
```

### ç”Ÿå‘½å‘¨æœŸç®¡ç†

| äº‹ä»¶ | è¡Œä¸º |
|------|------|
| ä»»åŠ¡å®Œæˆ | ä¿æŒçª—å£ï¼Œé€šçŸ¥ä¸» Agentï¼Œç­‰å¾…ç¡®è®¤ |
| ç”¨æˆ·ç¡®è®¤ | å…³é—­ Subagent çª—å£ï¼Œé‡Šæ”¾èµ„æº |
| ä»»åŠ¡å¤±è´¥ | é˜»å¡ä¸‹æ¸¸ä»»åŠ¡ï¼Œé€šçŸ¥ç”¨æˆ·ä»‹å…¥ |
| è¶…æ—¶ | æ ‡è®°å¤±è´¥ï¼ŒåŒä¸Š |

### ç¼–æ’ç•Œé¢ç¤ºæ„

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                     ä»»åŠ¡ç¼–æ’ç•Œé¢                              â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                             â”‚
â”‚  ğŸ“‹ ä»»åŠ¡è®¡åˆ’: "å®ç°ç”¨æˆ·è®¤è¯æ¨¡å—"                              â”‚
â”‚                                                             â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚  [1] è®¾è®¡æ•°æ®åº“ Schema        âœ… å®Œæˆ               â”‚   â”‚
â”‚  â”‚      â””â”€â”€ æ— ä¾èµ–                                     â”‚   â”‚
â”‚  â”‚                                                     â”‚   â”‚
â”‚  â”‚  [2] å®ç°åç«¯ API             ğŸ”„ è¿›è¡Œä¸­             â”‚   â”‚
â”‚  â”‚      â””â”€â”€ ä¾èµ–: [1]            âš¡ è‡ªåŠ¨å¯åŠ¨            â”‚   â”‚
â”‚  â”‚                                                     â”‚   â”‚
â”‚  â”‚  [3] å®ç°å‰ç«¯ç»„ä»¶             â¸ï¸ ç­‰å¾…               â”‚   â”‚
â”‚  â”‚      â””â”€â”€ ä¾èµ–: [2]            ğŸ–ï¸ æ‰‹åŠ¨å¯åŠ¨            â”‚   â”‚
â”‚  â”‚                                                     â”‚   â”‚
â”‚  â”‚  [4] ç¼–å†™æµ‹è¯•ç”¨ä¾‹             â¸ï¸ ç­‰å¾…               â”‚   â”‚
â”‚  â”‚      â””â”€â”€ ä¾èµ–: [2,3]          âš¡ è‡ªåŠ¨å¯åŠ¨            â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                             â”‚
â”‚  è°ƒåº¦æ¨¡å¼: [â—‰ æ··åˆ] [ ] å…¨æ‰‹åŠ¨ [ ] å…¨è‡ªåŠ¨                    â”‚
â”‚                                                             â”‚
â”‚  [â–¶ï¸ å¯åŠ¨ä»»åŠ¡ 3]  [â¹ï¸ æš‚åœè‡ªåŠ¨è°ƒåº¦]  [ğŸ“Š æŸ¥çœ‹ DAG]           â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## 5. MVP ä¸ Roadmap

### MVP èŒƒå›´ï¼ˆæœ€å°å¯è¡Œäº§å“ï¼‰

| åŠŸèƒ½ | éªŒæ”¶æ ‡å‡† |
|------|----------|
| **â‘  çŠ¶æ€é€šçŸ¥** | Claude Code å®Œæˆ/ç­‰å¾…è¾“å…¥æ—¶ï¼ŒTelegram æ”¶åˆ°é€šçŸ¥ï¼Œå»¶è¿Ÿ < 3s |
| **â‘¡ ä¼šè¯åˆ—è¡¨** | PWA æ˜¾ç¤ºæ‰€æœ‰æ´»è·ƒä¼šè¯ï¼ŒåŒ…å«ï¼šçª—å£ IDã€çŠ¶æ€ã€æœ€åæ´»åŠ¨æ—¶é—´ |
| **â‘¢ è¿œç¨‹å›å¤** | é€šè¿‡ Telegram æˆ– PWA å›å¤ Claude çš„é—®é¢˜ï¼Œå›å¤æˆåŠŸæ³¨å…¥ç»ˆç«¯ |

### å®Œæ•´ Roadmap

#### Phase 0: åŸºç¡€è®¾æ–½

| ä»»åŠ¡ | éªŒæ”¶æ ‡å‡† |
|------|----------|
| P0.1 åˆ›å»ºä¸‰ä¸ªä»“åº“ï¼Œåˆå§‹åŒ–é¡¹ç›®ç»“æ„ | ä»“åº“åˆ›å»ºå®Œæˆï¼ŒREADME å’Œ LICENSE å°±ç»ª |
| P0.2 insprcode-server åŸºç¡€æ¡†æ¶ | Go é¡¹ç›®å¯ç¼–è¯‘è¿è¡Œï¼Œå¥åº·æ£€æŸ¥ç«¯ç‚¹ `/health` è¿”å› 200 |
| P0.3 Redis + SQLite åŒæ¨¡å¼å­˜å‚¨å±‚ | å•å…ƒæµ‹è¯•è¦†ç›–ä¸¤ç§å­˜å‚¨æ¨¡å¼çš„ CRUD |
| P0.4 å¯æ’æ‹”è®¤è¯æ¡†æ¶ | Local Token æ¨¡å¼è®¤è¯é€šè¿‡ï¼Œè¿”å›æ­£ç¡®ç”¨æˆ·ä¿¡æ¯ |
| P0.5 åŸºç¡€ CI/CD | PR è§¦å‘æ„å»ºå’Œæµ‹è¯•ï¼Œmain åˆ†æ”¯è‡ªåŠ¨æ„å»º Docker é•œåƒ |

#### Phase 1: MVP æ ¸å¿ƒ

| ä»»åŠ¡ | éªŒæ”¶æ ‡å‡† |
|------|----------|
| P1.1 insprcode-skill Hook è„šæœ¬ | å®‰è£…å Claude Code Stop äº‹ä»¶è§¦å‘çŠ¶æ€ä¸ŠæŠ¥ |
| P1.2 ä¼šè¯ç®¡ç† API | `/api/sessions` CRUD æ­£å¸¸ï¼ŒWebSocket çŠ¶æ€æ¨é€æ­£å¸¸ |
| P1.3 Telegram Bot é›†æˆ | Bot å¯åŠ¨æ­£å¸¸ï¼ŒLong Polling æ¥æ”¶æ¶ˆæ¯ |
| P1.4 çŠ¶æ€é€šçŸ¥æ¨é€ | Claude å®Œæˆ/ç­‰å¾…æ—¶ 3s å†…æ”¶åˆ° Telegram é€šçŸ¥ |
| P1.5 PWA åŸºç¡€ç•Œé¢ | ä¼šè¯åˆ—è¡¨é¡µé¢æ­£å¸¸æ˜¾ç¤ºï¼Œå®æ—¶æ›´æ–°çŠ¶æ€ |
| P1.6 è¿œç¨‹å›å¤åŠŸèƒ½ | Telegram/PWA å‘é€å›å¤ï¼Œtmux æ³¨å…¥æˆåŠŸï¼ŒClaude ç»§ç»­æ‰§è¡Œ |

#### Phase 2: å¢å¼ºåŠŸèƒ½

| ä»»åŠ¡ | éªŒæ”¶æ ‡å‡† |
|------|----------|
| P2.1 è¿œç¨‹æŒ‡ä»¤å‘é€ | å¯å‘é€æ–°æŒ‡ä»¤ï¼ˆä¸åªæ˜¯å›å¤é—®é¢˜ï¼‰ |
| P2.2 ä¼šè¯åˆ«åç®¡ç† | å¯è®¾ç½®/ä¿®æ”¹åˆ«åï¼Œåˆ—è¡¨ä¸­æ˜¾ç¤ºåˆ«å |
| P2.3 è¾“å‡ºé¢„è§ˆ | PWA å¯æŸ¥çœ‹æœ€è¿‘ 50 è¡Œè¾“å‡º |
| P2.4 Web Push é€šçŸ¥ | PWA è®¢é˜…æ¨é€ï¼Œæµè§ˆå™¨æ”¶åˆ°é€šçŸ¥ |
| P2.5 OIDC è®¤è¯æ¨¡å¼ | å¯¹æ¥æµ‹è¯• OIDC Providerï¼Œç™»å½•æµç¨‹æ­£å¸¸ |

#### Phase 3: Subagent ç¼–æ’

| ä»»åŠ¡ | éªŒæ”¶æ ‡å‡† |
|------|----------|
| P3.1 Plan/Task æ•°æ®æ¨¡å‹ | æ•°æ®æ¨¡å‹å®šä¹‰å®Œæˆï¼Œå­˜å‚¨å±‚æ”¯æŒ |
| P3.2 DAG ä¾èµ–è§£æå¼•æ“ | ç»™å®š Planï¼Œæ­£ç¡®è®¡ç®—ä»»åŠ¡æ‰§è¡Œé¡ºåº |
| P3.3 Subagent å¯åŠ¨å™¨ | å¯é€šè¿‡ API å¯åŠ¨æ–° Claude Code çª—å£ |
| P3.4 æ··åˆè°ƒåº¦æ¨¡å¼ | manual/auto/hybrid ä¸‰ç§æ¨¡å¼æ­£å¸¸å·¥ä½œ |
| P3.5 ç»“æœæ”¶é›†ä¸æ‘˜è¦ç”Ÿæˆ | ä»»åŠ¡å®Œæˆåç”Ÿæˆç»“æ„åŒ–æ‘˜è¦ JSON |
| P3.6 PWA ç¼–æ’ç•Œé¢ | DAG å¯è§†åŒ–æ˜¾ç¤ºï¼Œæ”¯æŒæ‰‹åŠ¨å¯åŠ¨/ç¡®è®¤æ“ä½œ |
| P3.7 å¤±è´¥å¤„ç† | ä»»åŠ¡å¤±è´¥åä¸‹æ¸¸é˜»å¡ï¼Œé€šçŸ¥ç”¨æˆ· |

**Phase 3 æ•´ä½“éªŒæ”¶**ï¼š3+ ä»»åŠ¡çš„ Plan è‡ªåŠ¨ç¼–æ’æ‰§è¡ŒæˆåŠŸï¼ŒDAG å¯è§†åŒ–æ­£å¸¸

#### Phase 4: SaaS ä¸Šçº¿

| ä»»åŠ¡ | éªŒæ”¶æ ‡å‡† |
|------|----------|
| P4.1 inspirai-user è®¤è¯é›†æˆ | JWKS éªŒè¯é€šè¿‡ï¼Œç”¨æˆ·ä¿¡æ¯æ­£ç¡®è·å– |
| P4.2 inspirai-admin ç®¡ç†åŠŸèƒ½é›†æˆ | ç®¡ç†åå°å¯æŸ¥çœ‹ç”¨æˆ·ã€ä¼šè¯ç»Ÿè®¡ |
| P4.3 K8s éƒ¨ç½²é…ç½® | Helm Chart éƒ¨ç½²æˆåŠŸï¼ŒHPA è‡ªåŠ¨æ‰©ç¼©å®¹æ­£å¸¸ |
| P4.4 MySQL å­˜å‚¨é€‚é… | åˆ‡æ¢ MySQL ååŠŸèƒ½æ­£å¸¸ |
| P4.5 ç›‘æ§å‘Šè­¦ | Prometheus æŒ‡æ ‡æš´éœ²ï¼ŒGrafana ä»ªè¡¨ç›˜æ­£å¸¸ |

**Phase 4 æ•´ä½“éªŒæ”¶**ï¼šSaaS ç¯å¢ƒéƒ¨ç½²æˆåŠŸï¼Œ100 å¹¶å‘å‹æµ‹é€šè¿‡ï¼Œç›‘æ§å‘Šè­¦æ­£å¸¸

#### Phase 5: åŸç”Ÿ App

| ä»»åŠ¡ | éªŒæ”¶æ ‡å‡† |
|------|----------|
| P5.1 Flutter é¡¹ç›®åˆå§‹åŒ– | é¡¹ç›®åˆ›å»ºï¼ŒiOS/Android æ¨¡æ‹Ÿå™¨è¿è¡Œæ­£å¸¸ |
| P5.2 è®¤è¯æµç¨‹ | OAuth2 PKCE ç™»å½•æµç¨‹æ­£å¸¸ |
| P5.3 ä¼šè¯åˆ—è¡¨ä¸çŠ¶æ€ç›‘æ§ | ä¸ PWA åŠŸèƒ½ä¸€è‡´ |
| P5.4 è¿œç¨‹æ§åˆ¶åŠŸèƒ½ | å›å¤/æŒ‡ä»¤åŠŸèƒ½æ­£å¸¸ |
| P5.5 Subagent ç¼–æ’ç•Œé¢ | DAG å¯è§†åŒ–ï¼Œç¼–æ’æ“ä½œæ­£å¸¸ |
| P5.6 æ¨é€é€šçŸ¥ | APNs (iOS) + FCM (Android) æ¨é€æ­£å¸¸ |
| P5.7 App Store / Play Store ä¸Šæ¶ | å®¡æ ¸é€šè¿‡ï¼Œå¯ä¸‹è½½å®‰è£… |

**Phase 5 æ•´ä½“éªŒæ”¶**ï¼šåŒç«¯ App ä¸Šæ¶æˆåŠŸï¼Œæ ¸å¿ƒåŠŸèƒ½ä¸ PWA ä¸€è‡´

#### Future Roadmap

| åŠŸèƒ½ | è¯´æ˜ |
|------|------|
| å¾®ä¿¡å…¬ä¼—å·é€šçŸ¥ | å›½å†…ç”¨æˆ·é€šçŸ¥æ¸ é“ |
| é’‰é’‰/é£ä¹¦é€šçŸ¥ | ä¼ä¸šç”¨æˆ·é€šçŸ¥æ¸ é“ |
| æ”¯æŒ Gemini CLI | æ‰©å±•åˆ°å…¶ä»– AI CLI |
| å›¢é˜Ÿåä½œ | å…±äº«ä¼šè¯ã€æƒé™ç®¡ç† |
| ä¼šè¯å†å²å›æ”¾ | æŸ¥çœ‹å†å²ä¼šè¯æ‰§è¡Œè¿‡ç¨‹ |
| AI è¾…åŠ©ä»»åŠ¡æ‹†è§£ | è‡ªåŠ¨ç”Ÿæˆ Plan |

---

## 6. æ•°æ®æ¨¡å‹ä¸ API

### æ ¸å¿ƒæ•°æ®æ¨¡å‹

```go
// Session ä¼šè¯ï¼ˆä¸€ä¸ª Claude Code çª—å£ï¼‰
type Session struct {
    ID        string    `json:"id"`         // å”¯ä¸€æ ‡è¯†
    UserID    string    `json:"user_id"`    // æ‰€å±ç”¨æˆ·
    Alias     string    `json:"alias"`      // åˆ«åï¼ˆå¯é€‰ï¼‰
    Status    string    `json:"status"`     // idle | waiting | running | done
    TmuxName  string    `json:"tmux_name"`  // tmux session åç§°
    ParentID  string    `json:"parent_id"`  // çˆ¶ä¼šè¯ IDï¼ˆSubagent åœºæ™¯ï¼‰
    PlanID    string    `json:"plan_id"`    // å…³è”çš„ Plan ID
    TaskID    string    `json:"task_id"`    // å…³è”çš„ Task ID
    LastOutput string   `json:"last_output"`// æœ€è¿‘è¾“å‡ºæ‘˜è¦
    CreatedAt time.Time `json:"created_at"`
    UpdatedAt time.Time `json:"updated_at"`
}

// Plan ä»»åŠ¡è®¡åˆ’
type Plan struct {
    ID          string    `json:"id"`
    UserID      string    `json:"user_id"`
    Name        string    `json:"name"`
    Mode        string    `json:"mode"`       // manual | auto | hybrid
    Status      string    `json:"status"`     // draft | running | done | failed
    Tasks       []Task    `json:"tasks"`
    CreatedAt   time.Time `json:"created_at"`
}

// Task å•ä¸ªä»»åŠ¡
type Task struct {
    ID          string   `json:"id"`
    PlanID      string   `json:"plan_id"`
    Prompt      string   `json:"prompt"`      // ä»»åŠ¡æŒ‡ä»¤
    DependsOn   []string `json:"depends_on"`  // ä¾èµ–çš„ Task ID
    Auto        bool     `json:"auto"`        // æ˜¯å¦è‡ªåŠ¨å¯åŠ¨
    Status      string   `json:"status"`      // pending | ready | running | done | confirmed | failed
    SessionID   string   `json:"session_id"`  // æ‰§è¡Œæ­¤ä»»åŠ¡çš„ Subagent
    Summary     string   `json:"summary"`     // å®Œæˆæ‘˜è¦
    GitCommit   string   `json:"git_commit"`  // äº§å‡º commit
    StartedAt   *time.Time `json:"started_at"`
    FinishedAt  *time.Time `json:"finished_at"`
}
```

### API æ¦‚è¦

| æ¨¡å— | ç«¯ç‚¹ | è¯´æ˜ |
|------|------|------|
| **ä¼šè¯** | `GET /api/sessions` | è·å–ä¼šè¯åˆ—è¡¨ |
| | `POST /api/sessions/:id/command` | å‘é€æŒ‡ä»¤/å›å¤ |
| | `PATCH /api/sessions/:id` | æ›´æ–°åˆ«åç­‰ |
| **è®¡åˆ’** | `POST /api/plans` | åˆ›å»ºä»»åŠ¡è®¡åˆ’ |
| | `GET /api/plans/:id` | è·å–è®¡åˆ’è¯¦æƒ…ï¼ˆå« DAGï¼‰ |
| | `POST /api/plans/:id/start` | å¯åŠ¨è®¡åˆ’æ‰§è¡Œ |
| **ä»»åŠ¡** | `POST /api/tasks/:id/start` | æ‰‹åŠ¨å¯åŠ¨ä»»åŠ¡ |
| | `POST /api/tasks/:id/confirm` | ç¡®è®¤ä»»åŠ¡å®Œæˆ |
| | `POST /api/tasks/:id/retry` | é‡è¯•å¤±è´¥ä»»åŠ¡ |
| **Hook** | `POST /api/hook/status` | Skill ä¸ŠæŠ¥çŠ¶æ€ |
| **WebSocket** | `WS /api/ws` | å®æ—¶çŠ¶æ€æ¨é€ |

### ç›®å½•ç»“æ„

```
insprcode-server/
â”œâ”€â”€ cmd/
â”‚   â””â”€â”€ server/main.go
â”œâ”€â”€ internal/
â”‚   â”œâ”€â”€ api/            # HTTP handlers
â”‚   â”œâ”€â”€ auth/           # å¯æ’æ‹”è®¤è¯
â”‚   â”‚   â”œâ”€â”€ provider.go # æ¥å£å®šä¹‰
â”‚   â”‚   â”œâ”€â”€ local.go
â”‚   â”‚   â”œâ”€â”€ oidc.go
â”‚   â”‚   â””â”€â”€ inspirai.go
â”‚   â”œâ”€â”€ session/        # ä¼šè¯ç®¡ç†
â”‚   â”œâ”€â”€ orchestrator/   # ä»»åŠ¡ç¼–æ’
â”‚   â”œâ”€â”€ notifier/       # é€šçŸ¥æ¨é€
â”‚   â”‚   â”œâ”€â”€ telegram.go
â”‚   â”‚   â””â”€â”€ webpush.go
â”‚   â””â”€â”€ store/          # å­˜å‚¨å±‚
â”‚       â”œâ”€â”€ store.go    # æ¥å£
â”‚       â”œâ”€â”€ sqlite.go
â”‚       â””â”€â”€ mysql.go
â”œâ”€â”€ web/                # PWA å‰ç«¯ (Vue 3)
â”œâ”€â”€ config/
â”œâ”€â”€ deployments/
â”‚   â”œâ”€â”€ docker/
â”‚   â””â”€â”€ k8s/
â””â”€â”€ go.mod
```

---

## é™„å½•

### A. å‚è€ƒé¡¹ç›®

| é¡¹ç›® | è¯´æ˜ | å€Ÿé‰´ç‚¹ |
|------|------|--------|
| [Claude-Code-Remote](https://github.com/JessyTsui/Claude-Code-Remote) | Hook + Webhook æ–¹æ¡ˆ | Hook æœºåˆ¶ã€tmux æ³¨å…¥ |
| [ccremote](https://github.com/generativereality/ccremote) | é…é¢ç®¡ç† | è½®è¯¢æ£€æµ‹ã€Discord é›†æˆ |
| [claude-code-telegram](https://github.com/RichardAtCT/claude-code-telegram) | Telegram å®Œæ•´å®¢æˆ·ç«¯ | Bot äº¤äº’è®¾è®¡ |

### B. æŠ€æœ¯å†³ç­–è®°å½•

| å†³ç­– | é€‰é¡¹ | é€‰æ‹© | ç†ç”± |
|------|------|------|------|
| æœåŠ¡ç«¯è¯­è¨€ | Node.js / Go / Rust | Go | è½»é‡ã€å•äºŒè¿›åˆ¶ã€K8s å‹å¥½ |
| å‰ç«¯æ¡†æ¶ | Vue / React / Svelte | Vue 3 + Naive UI | è½»é‡ã€TypeScript å‹å¥½ |
| é€šçŸ¥æ¸ é“ | Telegram / Discord / å¾®ä¿¡ | Telegram (P0) | Long Polling æ— éœ€å…¬ç½‘ |
| å­˜å‚¨ | Redis Only / +SQLite / +MySQL | Redis + SQLite/MySQL | åŒæ¨¡å¼é€‚é… |
| è®¤è¯ | å•ä¸€æ¨¡å¼ / å¯æ’æ‹” | å¯æ’æ‹” | è‡ªæ‰˜ç®¡çµæ´»æ€§ |
